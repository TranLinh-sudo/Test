-- Dịch vụ cần thiết
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

-- Hàm tạo UI (Bảo vệ UI trong CoreGui nếu dùng Executor, hoặc PlayerGui nếu dùng Studio)
local function getParent()
	local success, result = pcall(function()
		return CoreGui
	end)
	if success then
		return result
	else
		return Players.LocalPlayer:WaitForChild("PlayerGui")
	end
end

-- --- CẤU HÌNH MÀU SẮC (GIỐNG ẢNH) ---
local Colors = {
	Background = Color3.fromRGB(20, 20, 20), -- Màu nền tối
	Sidebar = Color3.fromRGB(15, 15, 15),    -- Màu thanh bên
	ItemBG = Color3.fromRGB(30, 30, 30),     -- Màu nền của các mục chức năng
	Text = Color3.fromRGB(255, 255, 255),    -- Màu chữ trắng
	Accent = Color3.fromRGB(255, 215, 0),    -- Màu vàng (Gold) giống nút "Click" và tiêu đề
	Placeholder = Color3.fromRGB(150, 150, 150)
}

-- --- HÀM TẠO GIAO DIỆN CHÍNH ---
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "BananaCatHub_Replica"
ScreenGui.Parent = getParent()
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- 1. Main Frame (Khung chính)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Colors.Background
MainFrame.BackgroundTransparency = 0.1 -- Hơi trong suốt giống kính
MainFrame.Position = UDim2.new(0.5, -300, 0.5, -200) -- Căn giữa màn hình
MainFrame.Size = UDim2.new(0, 650, 0, 400)
MainFrame.BorderSizePixel = 0

-- Bo tròn góc Main Frame
local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 10)
MainCorner.Parent = MainFrame

-- Tiêu đề (Header)
local HeaderTitle = Instance.new("TextLabel")
HeaderTitle.Name = "Title"
HeaderTitle.Parent = MainFrame
HeaderTitle.BackgroundTransparency = 1
HeaderTitle.Position = UDim2.new(0, 160, 0, 10) -- Lệch sang phải để tránh Sidebar
HeaderTitle.Size = UDim2.new(1, -170, 0, 30)
HeaderTitle.Font = Enum.Font.GothamBold
HeaderTitle.Text = "Banana Cat Hub - Blox Fruit"
HeaderTitle.TextColor3 = Colors.Accent -- Màu vàng
HeaderTitle.TextSize = 18
HeaderTitle.TextXAlignment = Enum.TextXAlignment.Center

-- --- 2. SIDEBAR (THANH BÊN TRÁI) ---
local Sidebar = Instance.new("Frame")
Sidebar.Name = "Sidebar"
Sidebar.Parent = MainFrame
Sidebar.BackgroundColor3 = Colors.Sidebar
Sidebar.BackgroundTransparency = 0.5
Sidebar.Size = UDim2.new(0, 160, 1, 0)
Sidebar.BorderSizePixel = 0

local SidebarCorner = Instance.new("UICorner")
SidebarCorner.CornerRadius = UDim.new(0, 10)
SidebarCorner.Parent = Sidebar

-- Thanh tìm kiếm (Search Bar)
local SearchFrame = Instance.new("Frame")
SearchFrame.Name = "SearchFrame"
SearchFrame.Parent = Sidebar
SearchFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
SearchFrame.BackgroundTransparency = 0
SearchFrame.Position = UDim2.new(0, 10, 0, 15)
SearchFrame.Size = UDim2.new(1, -20, 0, 30)

local SearchCorner = Instance.new("UICorner")
SearchCorner.CornerRadius = UDim.new(0, 6)
SearchCorner.Parent = SearchFrame

local SearchBox = Instance.new("TextBox")
SearchBox.Parent = SearchFrame
SearchBox.BackgroundTransparency = 1
SearchBox.Size = UDim2.new(1, -10, 1, 0)
SearchBox.Position = UDim2.new(0, 10, 0, 0)
SearchBox.Font = Enum.Font.Gotham
SearchBox.PlaceholderText = "Search..."
SearchBox.Text = ""
SearchBox.TextColor3 = Colors.Text
SearchBox.TextSize = 12
SearchBox.TextXAlignment = Enum.TextXAlignment.Left

-- Danh sách Tab (ScrollingFrame)
local TabList = Instance.new("ScrollingFrame")
TabList.Name = "TabList"
TabList.Parent = Sidebar
TabList.Active = true
TabList.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TabList.BackgroundTransparency = 1
TabList.BorderSizePixel = 0
TabList.Position = UDim2.new(0, 0, 0, 60)
TabList.Size = UDim2.new(1, 0, 1, -70)
TabList.ScrollBarThickness = 2

local TabListLayout = Instance.new("UIListLayout")
TabListLayout.Parent = TabList
TabListLayout.SortOrder = Enum.SortOrder.LayoutOrder
TabListLayout.Padding = UDim.new(0, 5)

-- Container chứa các trang nội dung (Bên phải)
local ContentContainer = Instance.new("Frame")
ContentContainer.Name = "ContentContainer"
ContentContainer.Parent = MainFrame
ContentContainer.BackgroundTransparency = 1
ContentContainer.Position = UDim2.new(0, 170, 0, 50)
ContentContainer.Size = UDim2.new(1, -180, 1, -60)

-- --- HÀM HỖ TRỢ TẠO TAB VÀ CHỨC NĂNG ---

-- Hàm tạo Tab bên Sidebar
local currentTab = nil
local function CreateTab(name)
	-- Tạo trang nội dung cho Tab này
	local Page = Instance.new("ScrollingFrame")
	Page.Name = name .. "_Page"
	Page.Parent = ContentContainer
	Page.BackgroundTransparency = 1
	Page.Size = UDim2.new(1, 0, 1, 0)
	Page.ScrollBarThickness = 4
	Page.Visible = false -- Mặc định ẩn
	
	local PageLayout = Instance.new("UIListLayout")
	PageLayout.Parent = Page
	PageLayout.SortOrder = Enum.SortOrder.LayoutOrder
	PageLayout.Padding = UDim.new(0, 8)

	-- Tạo nút bấm bên Sidebar
	local TabButton = Instance.new("TextButton")
	TabButton.Name = name
	TabButton.Parent = TabList
	TabButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	TabButton.BackgroundTransparency = 1
	TabButton.Size = UDim2.new(1, 0, 0, 30)
	TabButton.Font = Enum.Font.GothamBold
	TabButton.Text = "   " .. name -- Thêm khoảng trắng để thụt lề
	TabButton.TextColor3 = Color3.fromRGB(150, 150, 150)
	TabButton.TextSize = 13
	TabButton.TextXAlignment = Enum.TextXAlignment.Left

	-- Xử lý sự kiện bấm Tab
	TabButton.MouseButton1Click:Connect(function()
		-- Reset màu các tab cũ
		for _, child in pairs(TabList:GetChildren()) do
			if child:IsA("TextButton") then
				child.TextColor3 = Color3.fromRGB(150, 150, 150)
			end
		end
		-- Ẩn tất cả các trang
		for _, child in pairs(ContentContainer:GetChildren()) do
			if child:IsA("ScrollingFrame") then
				child.Visible = false
			end
		end
		
		-- Active tab hiện tại
		TabButton.TextColor3 = Colors.Accent
		Page.Visible = true
	end)

	-- Chọn Tab đầu tiên làm mặc định
	if currentTab == nil then
		currentTab = Page
		Page.Visible = true
		TabButton.TextColor3 = Colors.Accent
	end

	return Page
end

-- Hàm tạo Chức năng (Nút bấm giống ảnh: Tên trái, Nút phải)
local function CreateItem(parentPage, text, callback)
	local ItemFrame = Instance.new("Frame")
	ItemFrame.Name = "Item"
	ItemFrame.Parent = parentPage
	ItemFrame.BackgroundColor3 = Colors.ItemBG
	ItemFrame.BackgroundTransparency = 0.5
	ItemFrame.Size = UDim2.new(1, 0, 0, 45)
	
	local ItemCorner = Instance.new("UICorner")
	ItemCorner.CornerRadius = UDim.new(0, 6)
	ItemCorner.Parent = ItemFrame
	
	-- Tên chức năng
	local ItemLabel = Instance.new("TextLabel")
	ItemLabel.Parent = ItemFrame
	ItemLabel.BackgroundTransparency = 1
	ItemLabel.Position = UDim2.new(0, 15, 0, 0)
	ItemLabel.Size = UDim2.new(0, 200, 1, 0)
	ItemLabel.Font = Enum.Font.GothamSemibold
	ItemLabel.Text = text
	ItemLabel.TextColor3 = Colors.Text
	ItemLabel.TextSize = 13
	ItemLabel.TextXAlignment = Enum.TextXAlignment.Left
	
	-- Nút "Click" màu vàng
	local ActionButton = Instance.new("TextButton")
	ActionButton.Parent = ItemFrame
	ActionButton.BackgroundColor3 = Colors.Accent -- Màu vàng
	ActionButton.Position = UDim2.new(1, -90, 0.5, -12) -- Căn phải
	ActionButton.Size = UDim2.new(0, 80, 0, 24)
	ActionButton.Font = Enum.Font.GothamBold
	ActionButton.Text = "Click"
	ActionButton.TextColor3 = Color3.fromRGB(0, 0, 0) -- Chữ đen trên nền vàng
	ActionButton.TextSize = 12
	
	local BtnCorner = Instance.new("UICorner")
	BtnCorner.CornerRadius = UDim.new(0, 12) -- Bo tròn hình viên thuốc
	BtnCorner.Parent = ActionButton
	
	ActionButton.MouseButton1Click:Connect(function()
		pcall(callback)
	end)
end

-- --- THÊM DỮ LIỆU GIỐNG ẢNH ---

-- Tạo các Tab
local Tab_Misc = CreateTab("Misc Shop") -- Đổi tên tab đầu tiên cho giống ảnh
local Tab_Running = CreateTab("Running Other")
local Tab_Fruit = CreateTab("Fruit and Raid")
local Tab_Sea = CreateTab("Sea Event")
local Tab_Race = CreateTab("Upgrade Race")
local Tab_Items = CreateTab("Get and Upgrade Items")
local Tab_Volcano = CreateTab("Volcano Event")
local Tab_ESP = CreateTab("ESP")

-- Tạo nội dung cho Tab "Misc Shop" (Giống ảnh)
CreateItem(Tab_Misc, "Redeem Code", function()
	print("Đã bấm Redeem Code")
	-- Code xử lý logic của bạn ở đây
end)

CreateItem(Tab_Misc, "Teleport Old World", function()
	print("Teleport Old World")
end)

CreateItem(Tab_Misc, "Teleport New World", function()
	print("Teleport New World")
end)

CreateItem(Tab_Misc, "Teleport Third Sea", function()
	print("Teleport Third Sea")
end)

CreateItem(Tab_Misc, "Buy Dual Flintlock", function()
	print("Buy Dual Flintlock")
end)

CreateItem(Tab_Misc, "Reroll Race", function()
	print("Reroll Race")
end)

-- --- CHỨC NĂNG KÉO THẢ (DRAGGABLE) ---
local dragging, dragInput, dragStart, startPos
local function update(input)
	local delta = input.Position - dragStart
	MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

MainFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = MainFrame.Position
		
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

MainFrame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		if dragging then
			update(input)
		end
	end
end)
