-- /////////////////////////////////////////////////////////////
-- /// BANANA CAT HUB - FIX STATUS & SERVER INFO ///
-- /////////////////////////////////////////////////////////////

if not game:IsLoaded() then game.Loaded:Wait() end

-- 1. D·ªäCH V·ª§
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local CoreGui = game:GetService("CoreGui")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- 2. C·∫§U H√åNH THEME
local Theme = {
    Background = Color3.fromRGB(25, 25, 25),
    YellowBorder = Color3.fromRGB(255, 235, 59),
    Text = Color3.fromRGB(255, 255, 255),
    Button = Color3.fromRGB(45, 45, 45),
    Red = Color3.fromRGB(255, 80, 80),
    Green = Color3.fromRGB(80, 255, 100),
    BananaCatImage = "http://www.roblox.com/asset/?id=13693437997"
}

-- 3. X·ª¨ L√ù GUI AN TO√ÄN (Safe GUI Load)
local GUI_NAME = "BananaCatHub_V3_Fix"
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")
local ParentTarget = nil

local success, result = pcall(function() return CoreGui end)
if success then ParentTarget = result else ParentTarget = PlayerGui end

if ParentTarget:FindFirstChild(GUI_NAME) then ParentTarget[GUI_NAME]:Destroy() end
if PlayerGui:FindFirstChild(GUI_NAME) then PlayerGui[GUI_NAME]:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = GUI_NAME
ScreenGui.Parent = ParentTarget
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false 

-- /////////////////////////////////////////////////////////////
-- /// GIAO DI·ªÜN CH√çNH ///
-- /////////////////////////////////////////////////////////////

-- ICON M·ªû
local OpenButton = Instance.new("ImageButton"); OpenButton.Parent = ScreenGui; OpenButton.BackgroundColor3 = Theme.Background; OpenButton.Position = UDim2.new(0.1, 0, 0.1, 0); OpenButton.Size = UDim2.new(0, 45, 0, 45); OpenButton.Image = Theme.BananaCatImage; OpenButton.BackgroundTransparency = 0.2
local OpenCorner = Instance.new("UICorner"); OpenCorner.CornerRadius = UDim.new(1, 0); OpenCorner.Parent = OpenButton
local OpenStroke = Instance.new("UIStroke"); OpenStroke.Color = Theme.YellowBorder; OpenStroke.Thickness = 2; OpenStroke.Parent = OpenButton

-- KHUNG MENU
local MainFrame = Instance.new("Frame"); MainFrame.Parent = ScreenGui; MainFrame.BackgroundColor3 = Theme.Background; MainFrame.BackgroundTransparency = 0.5; MainFrame.Size = UDim2.new(0, 550, 0, 280); MainFrame.Position = UDim2.new(0.5, -275, 0.5, -140); MainFrame.ClipsDescendants = true; MainFrame.Visible = true
local UICorner = Instance.new("UICorner"); UICorner.CornerRadius = UDim.new(0, 10); UICorner.Parent = MainFrame
local UIStroke = Instance.new("UIStroke"); UIStroke.Color = Theme.YellowBorder; UIStroke.Thickness = 3; UIStroke.Parent = MainFrame

-- HEADER
local Logo = Instance.new("ImageLabel"); Logo.Parent = MainFrame; Logo.BackgroundTransparency = 1; Logo.Position = UDim2.new(0, 5, 0, 3); Logo.Size = UDim2.new(0, 18, 0, 18); Logo.Image = Theme.BananaCatImage
local Title = Instance.new("TextLabel"); Title.Parent = MainFrame; Title.BackgroundTransparency = 1; Title.Position = UDim2.new(0, 28, 0, 3); Title.Size = UDim2.new(0, 200, 0, 18); Title.Font = Enum.Font.FredokaOne; Title.Text = "Banana Cat Hub"; Title.TextColor3 = Theme.YellowBorder; Title.TextSize = 14; Title.TextXAlignment = Enum.TextXAlignment.Left
local Separator = Instance.new("Frame"); Separator.Parent = MainFrame; Separator.BackgroundColor3 = Theme.YellowBorder; Separator.BorderSizePixel = 0; Separator.Position = UDim2.new(0, 0, 0, 25); Separator.Size = UDim2.new(1, 0, 0, 2)

-- CONTROLS
local CloseButton = Instance.new("TextButton"); CloseButton.Parent = MainFrame; CloseButton.BackgroundColor3 = Theme.Red; CloseButton.Position = UDim2.new(1, -22, 0, 4); CloseButton.Size = UDim2.new(0, 18, 0, 18); CloseButton.Font = Enum.Font.FredokaOne; CloseButton.Text = "X"; CloseButton.TextColor3 = Color3.new(1,1,1); CloseButton.TextSize = 12; local CloseCorner = Instance.new("UICorner"); CloseCorner.CornerRadius = UDim.new(0, 4); CloseCorner.Parent = CloseButton
local MinimizeButton = Instance.new("TextButton"); MinimizeButton.Parent = MainFrame; MinimizeButton.BackgroundColor3 = Theme.Orange; MinimizeButton.Position = UDim2.new(1, -44, 0, 4); MinimizeButton.Size = UDim2.new(0, 18, 0, 18); MinimizeButton.Font = Enum.Font.FredokaOne; MinimizeButton.Text = "-"; MinimizeButton.TextColor3 = Color3.new(1,1,1); MinimizeButton.TextSize = 14; local MinCorner = Instance.new("UICorner"); MinCorner.CornerRadius = UDim.new(0, 4); MinCorner.Parent = MinimizeButton

-- LOGIC GUI
CloseButton.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)
MinimizeButton.MouseButton1Click:Connect(function() MainFrame.Visible = false end)
OpenButton.MouseButton1Click:Connect(function()
    if MainFrame.Visible then MainFrame.Visible = false else MainFrame.Visible = true; MainFrame.Size = UDim2.new(0, 550, 0, 0); TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back), {Size = UDim2.new(0, 550, 0, 280)}):Play() end
end)

-- TAB SYSTEM
local Sidebar = Instance.new("ScrollingFrame"); Sidebar.Parent = MainFrame; Sidebar.Active = true; Sidebar.BackgroundColor3 = Theme.Background; Sidebar.BackgroundTransparency = 1; Sidebar.BorderSizePixel = 0; Sidebar.Position = UDim2.new(0, 5, 0, 30); Sidebar.Size = UDim2.new(0, 95, 0, 245); Sidebar.ScrollBarThickness = 2; Sidebar.ScrollBarImageColor3 = Theme.YellowBorder
local SidebarLayout = Instance.new("UIListLayout"); SidebarLayout.Parent = Sidebar; SidebarLayout.SortOrder = Enum.SortOrder.LayoutOrder; SidebarLayout.Padding = UDim.new(0, 5)

local VSeparator = Instance.new("Frame"); VSeparator.Parent = MainFrame; VSeparator.BackgroundColor3 = Theme.YellowBorder; VSeparator.BorderSizePixel = 0; VSeparator.Position = UDim2.new(0, 105, 0, 25); VSeparator.Size = UDim2.new(0, 2, 1, -25)
local PageContainer = Instance.new("Frame"); PageContainer.Parent = MainFrame; PageContainer.BackgroundTransparency = 1; PageContainer.Position = UDim2.new(0, 115, 0, 30); PageContainer.Size = UDim2.new(0, 425, 0, 240)

local FirstTab = nil
local function CreateTab(TabName)
    local TabButton = Instance.new("TextButton"); TabButton.Parent = Sidebar; TabButton.BackgroundColor3 = Theme.Button; TabButton.Size = UDim2.new(1, 0, 0, 25); TabButton.Font = Enum.Font.GothamBold; TabButton.Text = TabName; TabButton.TextColor3 = Theme.Text; TabButton.TextSize = 11; local TCorner = Instance.new("UICorner"); TCorner.CornerRadius = UDim.new(0, 4); TCorner.Parent = TabButton
    local Page = Instance.new("ScrollingFrame"); Page.Parent = PageContainer; Page.BackgroundTransparency = 1; Page.Size = UDim2.new(1, 0, 1, 0); Page.ScrollBarThickness = 2; Page.ScrollBarImageColor3 = Theme.YellowBorder; Page.Visible = false; local PageLayout = Instance.new("UIListLayout"); PageLayout.Parent = Page; PageLayout.SortOrder = Enum.SortOrder.LayoutOrder; PageLayout.Padding = UDim.new(0, 5)
    
    TabButton.MouseButton1Click:Connect(function()
        for _, item in pairs(PageContainer:GetChildren()) do if item:IsA("ScrollingFrame") then item.Visible = false end end
        for _, btn in pairs(Sidebar:GetChildren()) do if btn:IsA("TextButton") then btn.BackgroundColor3 = Theme.Button; btn.TextColor3 = Theme.Text end end
        Page.Visible = true; TabButton.BackgroundColor3 = Theme.YellowBorder; TabButton.TextColor3 = Color3.new(0,0,0)
    end)
    if FirstTab == nil then FirstTab = {Button = TabButton, Page = Page} end
    return Page
end

-- T·∫†O 14 TAB
local Tab1 = CreateTab("Tr·∫°ng th√°i"); local Tab2 = CreateTab("M√°y ch·ªß"); local Tab3 = CreateTab("Chung"); local Tab4 = CreateTab("Bi·ªÉn"); local Tab5 = CreateTab("V·∫≠t ph·∫©m"); local Tab6 = CreateTab("Tr√°i & Raid"); local Tab7 = CreateTab("Di chuy·ªÉn"); local Tab8 = CreateTab("C·ª≠a h√†ng"); local Tab9 = CreateTab("T·ªôc v4"); local Tab10 = CreateTab("Leviathan"); local Tab11 = CreateTab("N√∫i l·ª≠a"); local Tab12 = CreateTab("ƒê·∫£o c√°o"); local Tab13 = CreateTab("ƒê·ªãnh v·ªã"); local Tab14 = CreateTab("C√†i ƒë·∫∑t")

if FirstTab then FirstTab.Button.BackgroundColor3 = Theme.YellowBorder; FirstTab.Button.TextColor3 = Color3.new(0,0,0); FirstTab.Page.Visible = true end

-- K√âO TH·∫¢
local function MakeDraggable(object)
    local dragging, dragInput, dragStart, startPos
    object.InputBegan:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = true; dragStart = input.Position; startPos = object.Position; input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end) end end)
    object.InputChanged:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then dragInput = input end end)
    UserInputService.InputChanged:Connect(function(input) if input == dragInput and dragging then local delta = input.Position - dragStart; TweenService:Create(object, TweenInfo.new(0.05), {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}):Play() end end)
end
MakeDraggable(MainFrame); MakeDraggable(OpenButton)

-- /////////////////////////////////////////////////////////////
-- /// LOGIC TAB 1: STATUS (FIXED) ///
-- /////////////////////////////////////////////////////////////

-- H√†m t·∫°o Label (C√≥ ki·ªÉm tra l·ªói)
local function CreateInfoLabel(Parent, Title)
    local Frame = Instance.new("Frame"); Frame.Parent = Parent; Frame.BackgroundTransparency = 1; Frame.Size = UDim2.new(1, -10, 0, 20)
    local TitleLabel = Instance.new("TextLabel"); TitleLabel.Parent = Frame; TitleLabel.BackgroundTransparency = 1; TitleLabel.Position = UDim2.new(0, 0, 0, 0); TitleLabel.Size = UDim2.new(0.6, 0, 1, 0); TitleLabel.Font = Enum.Font.GothamBold; TitleLabel.Text = Title; TitleLabel.TextColor3 = Color3.fromRGB(200, 200, 200); TitleLabel.TextSize = 13; TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    local ValueLabel = Instance.new("TextLabel"); ValueLabel.Parent = Frame; ValueLabel.BackgroundTransparency = 1; ValueLabel.Position = UDim2.new(0.6, 0, 0, 0); ValueLabel.Size = UDim2.new(0.4, 0, 1, 0); ValueLabel.Font = Enum.Font.GothamBold; ValueLabel.Text = "Wait..."; ValueLabel.TextColor3 = Theme.YellowBorder; ValueLabel.TextSize = 13; ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
    return ValueLabel
end
local function CreateHeader(Parent, Text)
    local Label = Instance.new("TextLabel"); Label.Parent = Parent; Label.BackgroundTransparency = 1; Label.Size = UDim2.new(1, 0, 0, 25); Label.Font = Enum.Font.FredokaOne; Label.Text = "--- " .. Text .. " ---"; Label.TextColor3 = Theme.Text; Label.TextSize = 16
end

CreateHeader(Tab1, "TH√îNG TIN NH√ÇN V·∫¨T")
local Lb_Name = CreateInfoLabel(Tab1, "T√™n:")
local Lb_Level = CreateInfoLabel(Tab1, "C·∫•p ƒë·ªô:")
local Lb_Beli = CreateInfoLabel(Tab1, "Beli:")
local Lb_Frag = CreateInfoLabel(Tab1, "Fragment:")
local Lb_Race = CreateInfoLabel(Tab1, "T·ªôc:")
local Lb_Fruit = CreateInfoLabel(Tab1, "Tr√°i:")

local Spacer = Instance.new("Frame"); Spacer.Parent = Tab1; Spacer.Size = UDim2.new(1,0,0,10); Spacer.BackgroundTransparency=1

CreateHeader(Tab1, "TR·∫†NG TH√ÅI SERVER")
local Lb_Moon = CreateInfoLabel(Tab1, "Full Moon:")
local Lb_Mirage = CreateInfoLabel(Tab1, "Mirage Island:")
local Lb_Kitsune = CreateInfoLabel(Tab1, "Kitsune Island:")
local Lb_Indra = CreateInfoLabel(Tab1, "Rip_Indra:")
local Lb_Elite = CreateInfoLabel(Tab1, "Elite Hunter:")
local Lb_Frozen = CreateInfoLabel(Tab1, "Frozen Dimension:")

-- H√ÄM C·∫¨P NH·∫¨T (LOOP AN TO√ÄN)
task.spawn(function()
    while true do
        task.wait(1) -- C·∫≠p nh·∫≠t m·ªói gi√¢y
        
        -- D√πng pcall ƒë·ªÉ n·∫øu c√≥ l·ªói c≈©ng kh√¥ng l√†m s·∫≠p script
        local success, err = pcall(function()
            local Plr = Players.LocalPlayer
            
            -- 1. C·∫¨P NH·∫¨T NH√ÇN V·∫¨T (Ki·ªÉm tra xem Data ƒë√£ t·∫£i ch∆∞a)
            Lb_Name.Text = Plr.DisplayName
            
            if Plr:FindFirstChild("Data") then
                local Data = Plr.Data
                if Data:FindFirstChild("Level") then Lb_Level.Text = tostring(Data.Level.Value) end
                if Data:FindFirstChild("Fragments") then Lb_Frag.Text = tostring(Data.Fragments.Value) end
                if Data:FindFirstChild("Race") then Lb_Race.Text = tostring(Data.Race.Value) end
                if Data:FindFirstChild("DevilFruit") then Lb_Fruit.Text = tostring(Data.DevilFruit.Value) end
            else
                Lb_Level.Text = "Loading..."
            end

            -- L·∫•y ti·ªÅn (Beli)
            if Plr:FindFirstChild("leaderstats") and Plr.leaderstats:FindFirstChild("Beli") then
                 Lb_Beli.Text = "$" .. Plr.leaderstats.Beli.Value
            else
                 Lb_Beli.Text = "Loading..."
            end

            -- 2. C·∫¨P NH·∫¨T SERVER (D√πng Workspace Check)
            
            -- Full Moon Check
            if Lighting:GetMoonPhase() == Enum.MoonPhase.Full then 
                Lb_Moon.Text = "‚úÖ C√≥ (100%)"
                Lb_Moon.TextColor3 = Theme.Green 
            else 
                Lb_Moon.Text = "‚ùå Kh√¥ng"
                Lb_Moon.TextColor3 = Theme.Red 
            end

            -- Mirage Island Check (T√¨m k·ªπ trong WorldOrigin)
            local Mirage = workspace:FindFirstChild("Mirage Island") or (workspace:FindFirstChild("_WorldOrigin") and workspace._WorldOrigin:FindFirstChild("Locations") and workspace._WorldOrigin.Locations:FindFirstChild("Mirage Island"))
            if Mirage then 
                Lb_Mirage.Text = "‚úÖ ƒê√£ Xu·∫•t Hi·ªán"
                Lb_Mirage.TextColor3 = Theme.Green 
            else 
                Lb_Mirage.Text = "‚ùå Ch∆∞a c√≥"
                Lb_Mirage.TextColor3 = Theme.Red 
            end

            -- Kitsune Island Check
            if workspace.Map:FindFirstChild("Kitsune Island") then 
                Lb_Kitsune.Text = "‚úÖ ƒê√£ Xu·∫•t Hi·ªán"
                Lb_Kitsune.TextColor3 = Theme.Green 
            else 
                Lb_Kitsune.Text = "‚ùå Ch∆∞a c√≥"
                Lb_Kitsune.TextColor3 = Theme.Red 
            end

            -- Boss: Indra
            if workspace.Enemies:FindFirstChild("rip_indra True Form") then 
                Lb_Indra.Text = "‚öîÔ∏è ƒêANG ƒê√ÅNH"
                Lb_Indra.TextColor3 = Theme.Green 
            else 
                Lb_Indra.Text = "‚ùå Ch∆∞a c√≥"
                Lb_Indra.TextColor3 = Theme.Red 
            end

            -- Elite Hunter Check
            local EliteFound = false
            if workspace.Enemies then
                for _, v in pairs(workspace.Enemies:GetChildren()) do
                    if v.Name == "Deandre" or v.Name == "Diablo" or v.Name == "Urban" then
                        Lb_Elite.Text = "üéØ " .. v.Name
                        Lb_Elite.TextColor3 = Theme.Green
                        EliteFound = true
                        break
                    end
                end
            end
            if not EliteFound then 
                Lb_Elite.Text = "‚ùå Ch∆∞a c√≥"
                Lb_Elite.TextColor3 = Theme.Red 
            end
            
            -- Frozen Dimension (C·∫ßn check map ƒë·∫∑c bi·ªát)
            if workspace.Map:FindFirstChild("Frozen Dimension") then
                Lb_Frozen.Text = "‚úÖ M·ªü C·ª≠a"
                Lb_Frozen.TextColor3 = Theme.Green
            else
                Lb_Frozen.Text = "‚ùå ƒê√≥ng"
                Lb_Frozen.TextColor3 = Theme.Red
            end
            
        end)

        -- N·∫øu l·ªói th√¨ in ra Console (F9) ƒë·ªÉ bi·∫øt
        if not success then
            warn("L·ªói update status: " .. tostring(err))
        end
    end
end)

print("Banana Cat Hub V3 - Fix Load Loaded!")
