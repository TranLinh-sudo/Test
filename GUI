-- /////////////////////////////////////////////////////////////
-- /// BANANA CAT HUB - FINAL FULL VERSION ///
-- /////////////////////////////////////////////////////////////

repeat task.wait() until game:IsLoaded()

-- 1. D·ªäCH V·ª§ & ANTI-AFK
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local CoreGui = game:GetService("CoreGui")
local VirtualUser = game:GetService("VirtualUser")

-- Anti-AFK
Players.LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

-- 2. C·∫§U H√åNH THEME
local Theme = {
    Background = Color3.fromRGB(25, 25, 25),
    YellowBorder = Color3.fromRGB(255, 235, 59),
    Text = Color3.fromRGB(255, 255, 255),
    Button = Color3.fromRGB(45, 45, 45),
    Red = Color3.fromRGB(255, 80, 80),
    Green = Color3.fromRGB(80, 255, 100),
    Orange = Color3.fromRGB(255, 170, 0),
    BananaCatImage = "http://www.roblox.com/asset/?id=13693437997"
}

-- 3. X·ª¨ L√ù GUI AN TO√ÄN (Safe GUI Load)
local GUI_NAME = "BananaCatHub_Final"
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")
local ParentTarget = nil

local success, result = pcall(function() return CoreGui end)
if success then ParentTarget = result else ParentTarget = PlayerGui end

if ParentTarget:FindFirstChild(GUI_NAME) then ParentTarget[GUI_NAME]:Destroy() end
if PlayerGui:FindFirstChild(GUI_NAME) then PlayerGui[GUI_NAME]:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = GUI_NAME
ScreenGui.Parent = ParentTarget
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false 

-- /////////////////////////////////////////////////////////////
-- /// GIAO DI·ªÜN CH√çNH ///
-- /////////////////////////////////////////////////////////////

-- ICON M·ªû (TOGGLE)
local OpenButton = Instance.new("ImageButton"); OpenButton.Parent = ScreenGui; OpenButton.BackgroundColor3 = Theme.Background; OpenButton.Position = UDim2.new(0.1, 0, 0.1, 0); OpenButton.Size = UDim2.new(0, 45, 0, 45); OpenButton.Image = Theme.BananaCatImage; OpenButton.BackgroundTransparency = 0.2
local OpenCorner = Instance.new("UICorner"); OpenCorner.CornerRadius = UDim.new(1, 0); OpenCorner.Parent = OpenButton
local OpenStroke = Instance.new("UIStroke"); OpenStroke.Color = Theme.YellowBorder; OpenStroke.Thickness = 2; OpenStroke.Parent = OpenButton

-- KHUNG MENU
local MainFrame = Instance.new("Frame"); MainFrame.Parent = ScreenGui; MainFrame.BackgroundColor3 = Theme.Background; MainFrame.BackgroundTransparency = 0.5; MainFrame.Size = UDim2.new(0, 550, 0, 280); MainFrame.Position = UDim2.new(0.5, -275, 0.5, -140); MainFrame.ClipsDescendants = true; MainFrame.Visible = true
local UICorner = Instance.new("UICorner"); UICorner.CornerRadius = UDim.new(0, 10); UICorner.Parent = MainFrame
local UIStroke = Instance.new("UIStroke"); UIStroke.Color = Theme.YellowBorder; UIStroke.Thickness = 3; UIStroke.Parent = MainFrame

-- HEADER
local Logo = Instance.new("ImageLabel"); Logo.Parent = MainFrame; Logo.BackgroundTransparency = 1; Logo.Position = UDim2.new(0, 5, 0, 3); Logo.Size = UDim2.new(0, 18, 0, 18); Logo.Image = Theme.BananaCatImage
local Title = Instance.new("TextLabel"); Title.Parent = MainFrame; Title.BackgroundTransparency = 1; Title.Position = UDim2.new(0, 28, 0, 3); Title.Size = UDim2.new(0, 200, 0, 18); Title.Font = Enum.Font.FredokaOne; Title.Text = "Banana Cat Hub"; Title.TextColor3 = Theme.YellowBorder; Title.TextSize = 14; Title.TextXAlignment = Enum.TextXAlignment.Left
local Separator = Instance.new("Frame"); Separator.Parent = MainFrame; Separator.BackgroundColor3 = Theme.YellowBorder; Separator.BorderSizePixel = 0; Separator.Position = UDim2.new(0, 0, 0, 25); Separator.Size = UDim2.new(1, 0, 0, 2)

-- CONTROLS (N√∫t X v√† -)
local CloseButton = Instance.new("TextButton"); CloseButton.Parent = MainFrame; CloseButton.BackgroundColor3 = Theme.Red; CloseButton.Position = UDim2.new(1, -22, 0, 4); CloseButton.Size = UDim2.new(0, 18, 0, 18); CloseButton.Font = Enum.Font.FredokaOne; CloseButton.Text = "X"; CloseButton.TextColor3 = Color3.new(1,1,1); CloseButton.TextSize = 12; local CloseCorner = Instance.new("UICorner"); CloseCorner.CornerRadius = UDim.new(0, 4); CloseCorner.Parent = CloseButton
local MinimizeButton = Instance.new("TextButton"); MinimizeButton.Parent = MainFrame; MinimizeButton.BackgroundColor3 = Theme.Orange; MinimizeButton.Position = UDim2.new(1, -44, 0, 4); MinimizeButton.Size = UDim2.new(0, 18, 0, 18); MinimizeButton.Font = Enum.Font.FredokaOne; MinimizeButton.Text = "-"; MinimizeButton.TextColor3 = Color3.new(1,1,1); MinimizeButton.TextSize = 14; local MinCorner = Instance.new("UICorner"); MinCorner.CornerRadius = UDim.new(0, 4); MinCorner.Parent = MinimizeButton

-- LOGIC GUI
CloseButton.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)
MinimizeButton.MouseButton1Click:Connect(function() MainFrame.Visible = false end)
OpenButton.MouseButton1Click:Connect(function()
    if MainFrame.Visible then MainFrame.Visible = false else MainFrame.Visible = true; MainFrame.Size = UDim2.new(0, 550, 0, 0); TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back), {Size = UDim2.new(0, 550, 0, 280)}):Play() end
end)

-- TAB SYSTEM
local Sidebar = Instance.new("ScrollingFrame"); Sidebar.Parent = MainFrame; Sidebar.Active = true; Sidebar.BackgroundColor3 = Theme.Background; Sidebar.BackgroundTransparency = 1; Sidebar.BorderSizePixel = 0; Sidebar.Position = UDim2.new(0, 5, 0, 30); Sidebar.Size = UDim2.new(0, 95, 0, 245); Sidebar.ScrollBarThickness = 2; Sidebar.ScrollBarImageColor3 = Theme.YellowBorder
local SidebarLayout = Instance.new("UIListLayout"); SidebarLayout.Parent = Sidebar; SidebarLayout.SortOrder = Enum.SortOrder.LayoutOrder; SidebarLayout.Padding = UDim.new(0, 5)

local VSeparator = Instance.new("Frame"); VSeparator.Parent = MainFrame; VSeparator.BackgroundColor3 = Theme.YellowBorder; VSeparator.BorderSizePixel = 0; VSeparator.Position = UDim2.new(0, 105, 0, 25); VSeparator.Size = UDim2.new(0, 2, 1, -25)
local PageContainer = Instance.new("Frame"); PageContainer.Parent = MainFrame; PageContainer.BackgroundTransparency = 1; PageContainer.Position = UDim2.new(0, 115, 0, 30); PageContainer.Size = UDim2.new(0, 425, 0, 240)

local FirstTab = nil
local function CreateTab(TabName)
    local TabButton = Instance.new("TextButton"); TabButton.Parent = Sidebar; TabButton.BackgroundColor3 = Theme.Button; TabButton.Size = UDim2.new(1, 0, 0, 25); TabButton.Font = Enum.Font.GothamBold; TabButton.Text = TabName; TabButton.TextColor3 = Theme.Text; TabButton.TextSize = 11; local TCorner = Instance.new("UICorner"); TCorner.CornerRadius = UDim.new(0, 4); TCorner.Parent = TabButton
    local Page = Instance.new("ScrollingFrame"); Page.Parent = PageContainer; Page.BackgroundTransparency = 1; Page.Size = UDim2.new(1, 0, 1, 0); Page.ScrollBarThickness = 2; Page.ScrollBarImageColor3 = Theme.YellowBorder; Page.Visible = false; local PageLayout = Instance.new("UIListLayout"); PageLayout.Parent = Page; PageLayout.SortOrder = Enum.SortOrder.LayoutOrder; PageLayout.Padding = UDim.new(0, 5)
    local PagePadding = Instance.new("UIPadding"); PagePadding.Parent = Page; PagePadding.PaddingTop = UDim.new(0, 5); PagePadding.PaddingLeft = UDim.new(0, 5)
    
    TabButton.MouseButton1Click:Connect(function()
        for _, item in pairs(PageContainer:GetChildren()) do if item:IsA("ScrollingFrame") then item.Visible = false end end
        for _, btn in pairs(Sidebar:GetChildren()) do if btn:IsA("TextButton") then btn.BackgroundColor3 = Theme.Button; btn.TextColor3 = Theme.Text end end
        Page.Visible = true; TabButton.BackgroundColor3 = Theme.YellowBorder; TabButton.TextColor3 = Color3.new(0,0,0)
    end)
    if FirstTab == nil then FirstTab = {Button = TabButton, Page = Page} end
    return Page
end

-- H√ÄM T·∫†O N√öT
local function AddButton(Page, Text, Callback)
    local Button = Instance.new("TextButton"); Button.Parent = Page; Button.BackgroundColor3 = Theme.Button; Button.Size = UDim2.new(1, -10, 0, 30); Button.Font = Enum.Font.GothamBold; Button.Text = Text; Button.TextColor3 = Theme.Text; Button.TextSize = 14; local BCorner = Instance.new("UICorner"); BCorner.CornerRadius = UDim.new(0, 6); BCorner.Parent = Button; local BStroke = Instance.new("UIStroke"); BStroke.Color = Theme.YellowBorder; BStroke.Thickness = 1; BStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border; BStroke.Parent = Button
    Button.MouseButton1Click:Connect(function() TweenService:Create(Button, TweenInfo.new(0.1), {Size = UDim2.new(1, -20, 0, 28)}):Play(); task.wait(0.1); TweenService:Create(Button, TweenInfo.new(1, -10, 0, 30)}):Play(); Callback() end)
end

-- T·∫†O 14 TAB
local Tab1 = CreateTab("Tr·∫°ng th√°i"); local Tab2 = CreateTab("M√°y ch·ªß"); local Tab3 = CreateTab("Chung"); local Tab4 = CreateTab("Bi·ªÉn"); local Tab5 = CreateTab("V·∫≠t ph·∫©m"); local Tab6 = CreateTab("Tr√°i & Raid"); local Tab7 = CreateTab("Di chuy·ªÉn"); local Tab8 = CreateTab("C·ª≠a h√†ng"); local Tab9 = CreateTab("T·ªôc v4"); local Tab10 = CreateTab("Leviathan"); local Tab11 = CreateTab("N√∫i l·ª≠a"); local Tab12 = CreateTab("ƒê·∫£o c√°o"); local Tab13 = CreateTab("ƒê·ªãnh v·ªã"); local Tab14 = CreateTab("C√†i ƒë·∫∑t")

if FirstTab then FirstTab.Button.BackgroundColor3 = Theme.YellowBorder; FirstTab.Button.TextColor3 = Color3.new(0,0,0); FirstTab.Page.Visible = true end

-- K√âO TH·∫¢ GUI
local function MakeDraggable(object)
    local dragging, dragInput, dragStart, startPos
    object.InputBegan:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = true; dragStart = input.Position; startPos = object.Position; input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end) end end)
    object.InputChanged:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then dragInput = input end end)
    UserInputService.InputChanged:Connect(function(input) if input == dragInput and dragging then local delta = input.Position - dragStart; TweenService:Create(object, TweenInfo.new(0.05), {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}):Play() end end)
end
MakeDraggable(MainFrame); MakeDraggable(OpenButton)

-- /////////////////////////////////////////////////////////////
-- /// LOGIC TAB 1: STATUS CAO C·∫§P (SERVER & PLAYER) ///
-- /////////////////////////////////////////////////////////////

local function CreateInfoLabel(Parent, Title)
    local Frame = Instance.new("Frame"); Frame.Parent = Parent; Frame.BackgroundTransparency = 1; Frame.Size = UDim2.new(1, -10, 0, 20)
    local TitleLabel = Instance.new("TextLabel"); TitleLabel.Parent = Frame; TitleLabel.BackgroundTransparency = 1; TitleLabel.Position = UDim2.new(0, 0, 0, 0); TitleLabel.Size = UDim2.new(0.5, 0, 1, 0); TitleLabel.Font = Enum.Font.GothamBold; TitleLabel.Text = Title; TitleLabel.TextColor3 = Color3.fromRGB(200, 200, 200); TitleLabel.TextSize = 13; TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    local ValueLabel = Instance.new("TextLabel"); ValueLabel.Parent = Frame; ValueLabel.BackgroundTransparency = 1; ValueLabel.Position = UDim2.new(0.5, 0, 0, 0); ValueLabel.Size = UDim2.new(0.5, 0, 1, 0); ValueLabel.Font = Enum.Font.GothamBold; ValueLabel.Text = "Loading..."; ValueLabel.TextColor3 = Theme.YellowBorder; ValueLabel.TextSize = 13; ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
    return ValueLabel
end
local function CreateHeader(Parent, Text)
    local Label = Instance.new("TextLabel"); Label.Parent = Parent; Label.BackgroundTransparency = 1; Label.Size = UDim2.new(1, 0, 0, 25); Label.Font = Enum.Font.FredokaOne; Label.Text = "--- " .. Text .. " ---"; Label.TextColor3 = Theme.Text; Label.TextSize = 16
end

-- T·∫†O DANH S√ÅCH TH√îNG TIN
CreateHeader(Tab1, "TH√îNG TIN NH√ÇN V·∫¨T")
local Lb_Name = CreateInfoLabel(Tab1, "T√™n nh√¢n v·∫≠t:")
local Lb_Level = CreateInfoLabel(Tab1, "C·∫•p ƒë·ªô:")
local Lb_Beli = CreateInfoLabel(Tab1, "Beli:")
local Lb_Frag = CreateInfoLabel(Tab1, "Fragment:")
local Lb_Race = CreateInfoLabel(Tab1, "T·ªôc:")
local Lb_Fruit = CreateInfoLabel(Tab1, "Tr√°i √°c qu·ª∑:")

local Spacer = Instance.new("Frame"); Spacer.Parent = Tab1; Spacer.Size = UDim2.new(1,0,0,10); Spacer.BackgroundTransparency=1

CreateHeader(Tab1, "TR·∫†NG TH√ÅI SERVER")
local Lb_Moon = CreateInfoLabel(Tab1, "Full Moon:")
local Lb_Mirage = CreateInfoLabel(Tab1, "Mirage Island:")
local Lb_Kitsune = CreateInfoLabel(Tab1, "Kitsune Island:")
local Lb_Dragon = CreateInfoLabel(Tab1, "Prehistoric Island:")
local Lb_Frozen = CreateInfoLabel(Tab1, "Frozen Dimension:")
local Lb_DimKill = CreateInfoLabel(Tab1, "Dough King Kills:")
local Lb_Tyrant = CreateInfoLabel(Tab1, "Tyrant of Skies:")
local Lb_Indra = CreateInfoLabel(Tab1, "Rip_Indra:")
local Lb_Elite = CreateInfoLabel(Tab1, "Elite Hunter:")
local Lb_Pulever = CreateInfoLabel(Tab1, "Pulever:")
local Lb_Sword = CreateInfoLabel(Tab1, "Legendary Sword:")

-- H√ÄM LOGIC PH·ª§
local function GetMoonStatus()
    local Phase = Lighting:GetMoonPhase()
    if Phase == Enum.MoonPhase.Full then return "‚úÖ ƒêANG C√ì (100%)", Theme.Green
    elseif Phase == Enum.MoonPhase.WaxingGibbous then return "‚è≥ C√≤n 1 ng√†y", Theme.Orange
    elseif Phase == Enum.MoonPhase.FirstQuarter then return "‚è≥ C√≤n 2 ng√†y", Theme.Orange
    elseif Phase == Enum.MoonPhase.WaxingCrescent then return "‚è≥ C√≤n 3 ng√†y", Theme.Orange
    elseif Phase == Enum.MoonPhase.New then return "üåë TrƒÉng non", Theme.Red
    else return "‚ùå ƒê√£ qua", Theme.Red end
end

local function GetDoughKingCount()
    local CounterFrame = workspace.Map:FindFirstChild("Cake Loaf")
    if CounterFrame and CounterFrame:FindFirstChild("Frames") and CounterFrame.Frames:FindFirstChild("Counter") then
        local Text = CounterFrame.Frames.Counter.TextLabel.Text
        local Count = tonumber(string.match(Text, "%d+"))
        if Count then return "ƒê√£ gi·∫øt: " .. Count .. " (C√≤n " .. (500 - Count) .. ")", Theme.YellowBorder end
    end
    return "N/A (C·∫ßn Sea 3)", Theme.Red
end

-- V√íNG L·∫∂P UPDATE (1 GI√ÇY 1 L·∫¶N)
task.spawn(function()
    while true do
        task.wait(1)
        pcall(function()
            local Plr = Players.LocalPlayer
            -- 1. Player Info
            Lb_Name.Text = Plr.DisplayName
            if Plr:FindFirstChild("Data") then
                local D = Plr.Data
                if D:FindFirstChild("Level") then Lb_Level.Text = tostring(D.Level.Value) end
                if D:FindFirstChild("Fragments") then Lb_Frag.Text = tostring(D.Fragments.Value) end
                if D:FindFirstChild("Race") then Lb_Race.Text = tostring(D.Race.Value) end
                if D:FindFirstChild("DevilFruit") then Lb_Fruit.Text = tostring(D.DevilFruit.Value) end
            end
            if Plr:FindFirstChild("leaderstats") and Plr.leaderstats:FindFirstChild("Beli") then
                 Lb_Beli.Text = "$" .. Plr.leaderstats.Beli.Value
            end

            -- 2. Server Status
            local MoonText, MoonColor = GetMoonStatus()
            Lb_Moon.Text = MoonText; Lb_Moon.TextColor3 = MoonColor

            if workspace._WorldOrigin.Locations:FindFirstChild("Mirage Island") then Lb_Mirage.Text = "‚úÖ ƒê√É XU·∫§T HI·ªÜN"; Lb_Mirage.TextColor3 = Theme.Green else Lb_Mirage.Text = "‚ùå Ch∆∞a c√≥"; Lb_Mirage.TextColor3 = Theme.Red end
            if workspace.Map:FindFirstChild("Kitsune Island") then Lb_Kitsune.Text = "‚úÖ ƒê√É XU·∫§T HI·ªÜN"; Lb_Kitsune.TextColor3 = Theme.Green else Lb_Kitsune.Text = "‚ùå Ch∆∞a c√≥"; Lb_Kitsune.TextColor3 = Theme.Red end
            if workspace.Map:FindFirstChild("Frozen Dimension") then Lb_Frozen.Text = "‚úÖ C·ªïng M·ªü"; Lb_Frozen.TextColor3 = Theme.Green else Lb_Frozen.Text = "‚ùå ƒê√≥ng"; Lb_Frozen.TextColor3 = Theme.Red end
            
            local DoughText, DoughColor = GetDoughKingCount()
            Lb_DimKill.Text = DoughText; Lb_DimKill.TextColor3 = DoughColor

            if workspace.Enemies:FindFirstChild("rip_indra True Form") then Lb_Indra.Text = "‚öîÔ∏è ƒêANG ƒê√ÅNH"; Lb_Indra.TextColor3 = Theme.Green else Lb_Indra.Text = "‚ùå Ch∆∞a c√≥"; Lb_Indra.TextColor3 = Theme.Red end
            
            -- Checks c∆° b·∫£n cho c√°c Boss kh√°c
            Lb_Dragon.Text = "Checking..."
            if workspace.Enemies:FindFirstChild("Tyrant of the Skies") then Lb_Tyrant.Text = "‚úÖ ƒêang s·ªëng"; Lb_Tyrant.TextColor3 = Theme.Green else Lb_Tyrant.Text = "‚ùå Ch∆∞a Spawn"; Lb_Tyrant.TextColor3 = Theme.Red end
            
            local EliteFound = false
            for _, v in pairs(workspace.Enemies:GetChildren()) do
                if v.Name == "Deandre" or v.Name == "Diablo" or v.Name == "Urban" then
                    Lb_Elite.Text = "üéØ " .. v.Name; Lb_Elite.TextColor3 = Theme.Green; EliteFound = true; break
                end
            end
            if not EliteFound then Lb_Elite.Text = "‚ùå Ch∆∞a c√≥"; Lb_Elite.TextColor3 = Theme.Red end
            
            if workspace:FindFirstChild("Legendary Sword Dealer") then Lb_Sword.Text = "‚úÖ ƒêang b√°n"; Lb_Sword.TextColor3 = Theme.Green else Lb_Sword.Text = "‚ùå V·∫Øng m·∫∑t"; Lb_Sword.TextColor3 = Theme.Red end
            Lb_Pulever.Text = "Checking..."
        end)
    end
end)

-- /////////////////////////////////////////////////////////////
-- /// PLACEHOLDERS (C√°c Tab kh√°c) ///
-- /////////////////////////////////////////////////////////////
AddButton(Tab2, "Server Hop (Coming Soon)", function() print("Hop") end)
AddButton(Tab3, "Auto Farm Level (Beta)", function() print("Farm") end)
AddButton(Tab7, "Teleport Sea 1", function() print("TP 1") end)
AddButton(Tab7, "Teleport Sea 2", function() print("TP 2") end)
AddButton(Tab7, "Teleport Sea 3", function() print("TP 3") end)

print("Banana Cat Hub Final Loaded!")
