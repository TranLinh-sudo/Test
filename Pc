local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local Mouse = LocalPlayer:GetMouse()

-- 1. C·∫§U H√åNH THEME
local THEME = {
    Background = Color3.fromRGB(18, 18, 18),
    Accent = Color3.fromRGB(255, 230, 0), -- M√†u v√†ng Banana
    Text = Color3.fromRGB(240, 240, 240),
    ItemBack = Color3.fromRGB(35, 35, 35),
    SidebarBack = Color3.fromRGB(25, 25, 25),
    Font = Enum.Font.GothamBold
}

if PlayerGui:FindFirstChild("BananaCatHub_Final") then
    PlayerGui.BananaCatHub_Final:Destroy()
end

-- 2. T·∫†O SCREEN GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "BananaCatHub_Final"
ScreenGui.Parent = PlayerGui
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- =========================================================
-- PH·∫¶N 1: N√öT ICON B·∫¨T/T·∫ÆT
-- =========================================================
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Name = "ToggleBtn"
ToggleBtn.Size = UDim2.new(0, 50, 0, 50)
ToggleBtn.Position = UDim2.new(0.05, 0, 0.1, 0)
ToggleBtn.BackgroundColor3 = THEME.Accent
ToggleBtn.Text = "üçå"
ToggleBtn.TextSize = 30
ToggleBtn.Font = Enum.Font.FredokaOne
ToggleBtn.Parent = ScreenGui
Instance.new("UICorner", ToggleBtn).CornerRadius = UDim.new(1, 0)
Instance.new("UIStroke", ToggleBtn).Thickness = 2

local function MakeDraggable(obj)
    local dragging, dragInput, dragStart, startPos
    obj.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = obj.Position
        end
    end)
    obj.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            obj.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    obj.InputEnded:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end end)
end
MakeDraggable(ToggleBtn)

-- =========================================================
-- PH·∫¶N 2: MAIN FRAME
-- =========================================================
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 600, 0, 350)
MainFrame.Position = UDim2.new(0.5, -300, 0.5, -175)
MainFrame.BackgroundColor3 = THEME.Background
MainFrame.BackgroundTransparency = 0.1
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 8)

ToggleBtn.MouseButton1Click:Connect(function() MainFrame.Visible = not MainFrame.Visible end)

local TitleBar = Instance.new("TextButton")
TitleBar.Size = UDim2.new(1, 0, 0, 40)
TitleBar.BackgroundTransparency = 1
TitleBar.Text = "   BANANA HUB üçå"
TitleBar.TextColor3 = THEME.Accent
TitleBar.TextSize = 20
TitleBar.Font = Enum.Font.FredokaOne
TitleBar.TextXAlignment = Enum.TextXAlignment.Left
TitleBar.Parent = MainFrame
MakeDraggable(MainFrame)

local ResizeHandle = Instance.new("TextButton")
ResizeHandle.Size = UDim2.new(0, 20, 0, 20)
ResizeHandle.Position = UDim2.new(1, -20, 1, -20)
ResizeHandle.BackgroundColor3 = THEME.Accent
ResizeHandle.Text = "‚ó¢"
ResizeHandle.Parent = MainFrame
Instance.new("UICorner", ResizeHandle).CornerRadius = UDim.new(0, 4)

local isResizing, resizeStartSize, resizeMouseStart
ResizeHandle.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isResizing = true; resizeStartSize = MainFrame.AbsoluteSize; resizeMouseStart = Vector2.new(input.Position.X, input.Position.Y)
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if isResizing and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = Vector2.new(input.Position.X, input.Position.Y) - resizeMouseStart
        MainFrame.Size = UDim2.new(0, math.max(400, resizeStartSize.X + delta.X), 0, math.max(250, resizeStartSize.Y + delta.Y))
    end
end)
UserInputService.InputEnded:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 then isResizing = false end end)

-- =========================================================
-- PH·∫¶N 3: C·∫§U TR√öC TAB & H√ÄM C√îNG C·ª§
-- =========================================================

local SidebarWidth = 120 

local Sidebar = Instance.new("ScrollingFrame")
Sidebar.Name = "Sidebar"
Sidebar.Size = UDim2.new(0, SidebarWidth, 1, -50)
Sidebar.Position = UDim2.new(0, 10, 0, 45)
Sidebar.BackgroundColor3 = THEME.SidebarBack
Sidebar.BackgroundTransparency = 0.5
Sidebar.ScrollBarThickness = 2
Sidebar.ScrollBarImageColor3 = THEME.Accent
Sidebar.BorderSizePixel = 0
Sidebar.CanvasSize = UDim2.new(0, 0, 0, 0)
Sidebar.AutomaticCanvasSize = Enum.AutomaticSize.Y 
Sidebar.Parent = MainFrame

local SidebarLayout = Instance.new("UIListLayout")
SidebarLayout.Padding = UDim.new(0, 5)
SidebarLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
SidebarLayout.SortOrder = Enum.SortOrder.LayoutOrder
SidebarLayout.Parent = Sidebar
Instance.new("UIPadding", Sidebar).PaddingTop = UDim.new(0, 5)

local PageContainer = Instance.new("Frame")
PageContainer.Size = UDim2.new(1, -(SidebarWidth + 20), 1, -55)
PageContainer.Position = UDim2.new(0, SidebarWidth + 15, 0, 45)
PageContainer.BackgroundTransparency = 1
PageContainer.Parent = MainFrame

local PageFolder = Instance.new("Folder")
PageFolder.Name = "Pages"
PageFolder.Parent = PageContainer

local TabCount = 0

local function CreateTab(name)
    TabCount = TabCount + 1
    local TabBtn = Instance.new("TextButton")
    TabBtn.Name = name .. "Btn"
    TabBtn.Text = name
    TabBtn.Size = UDim2.new(0, SidebarWidth - 10, 0, 35)
    TabBtn.BackgroundColor3 = THEME.ItemBack
    TabBtn.TextColor3 = THEME.Text
    TabBtn.Font = THEME.Font
    TabBtn.TextSize = 13 
    TabBtn.LayoutOrder = TabCount
    TabBtn.Parent = Sidebar
    Instance.new("UICorner", TabBtn).CornerRadius = UDim.new(0, 6)

    local Page = Instance.new("ScrollingFrame")
    Page.Name = name
    Page.Size = UDim2.new(1, 0, 1, 0)
    Page.BackgroundTransparency = 1
    Page.ScrollBarThickness = 4
    Page.Visible = false
    Page.CanvasSize = UDim2.new(0, 0, 0, 0)
    Page.AutomaticCanvasSize = Enum.AutomaticSize.Y
    Page.Parent = PageFolder
    
    local Layout = Instance.new("UIListLayout")
    Layout.Padding = UDim.new(0, 6)
    Layout.SortOrder = Enum.SortOrder.LayoutOrder
    Layout.Parent = Page
    
    local Pad = Instance.new("UIPadding")
    Pad.PaddingTop = UDim.new(0, 5)
    Pad.PaddingLeft = UDim.new(0, 5)
    Pad.PaddingBottom = UDim.new(0, 10)
    Pad.Parent = Page
    
    TabBtn.MouseButton1Click:Connect(function()
        for _, p in pairs(PageFolder:GetChildren()) do p.Visible = false end
        Page.Visible = true
        for _, btn in pairs(Sidebar:GetChildren()) do
            if btn:IsA("TextButton") then
                TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = THEME.ItemBack, TextColor3 = THEME.Text}):Play()
            end
        end
        TweenService:Create(TabBtn, TweenInfo.new(0.2), {BackgroundColor3 = THEME.Accent, TextColor3 = Color3.new(0,0,0)}):Play()
    end)
    return Page
end

-- --- H√ÄM T·∫†O N√öT ---
local function CreateButton(parentPage, text, callback)
    local Button = Instance.new("TextButton")
    Button.Text = text
    Button.Size = UDim2.new(1, -5, 0, 35)
    Button.BackgroundColor3 = THEME.ItemBack
    Button.TextColor3 = THEME.Text
    Button.Font = THEME.Font
    Button.TextSize = 14
    Button.Parent = parentPage
    Instance.new("UICorner", Button).CornerRadius = UDim.new(0, 6)
    
    Button.MouseButton1Click:Connect(function()
        if callback then callback() end
        local oldColor = Button.BackgroundColor3
        Button.BackgroundColor3 = THEME.Accent
        Button.TextColor3 = Color3.new(0,0,0)
        task.wait(0.1)
        Button.BackgroundColor3 = oldColor
        Button.TextColor3 = THEME.Text
    end)
end

-- --- H√ÄM T·∫†O DROPDOWN ---
local function CreateDropdown(parentPage, title, options, callback)
    local Dropdown = Instance.new("Frame")
    Dropdown.Size = UDim2.new(1, -5, 0, 35)
    Dropdown.BackgroundColor3 = THEME.ItemBack
    Dropdown.ClipsDescendants = true
    Dropdown.Parent = parentPage
    Instance.new("UICorner", Dropdown).CornerRadius = UDim.new(0, 6)
    
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Text = title
    TitleLabel.Size = UDim2.new(1, -30, 0, 35)
    TitleLabel.Position = UDim2.new(0, 10, 0, 0)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.TextColor3 = THEME.Text
    TitleLabel.Font = THEME.Font
    TitleLabel.TextSize = 14
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.Parent = Dropdown
    
    local OpenBtn = Instance.new("TextButton")
    OpenBtn.Size = UDim2.new(1, 0, 0, 35)
    OpenBtn.BackgroundTransparency = 1
    OpenBtn.Text = ""
    OpenBtn.Parent = Dropdown
    
    local Arrow = Instance.new("TextLabel")
    Arrow.Text = "‚ñº"
    Arrow.Size = UDim2.new(0, 30, 0, 35)
    Arrow.Position = UDim2.new(1, -30, 0, 0)
    Arrow.BackgroundTransparency = 1
    Arrow.TextColor3 = THEME.Text
    Arrow.TextSize = 12
    Arrow.Parent = Dropdown
    
    local OptionList = Instance.new("Frame")
    OptionList.Size = UDim2.new(1, 0, 0, 0)
    OptionList.Position = UDim2.new(0, 0, 0, 35)
    OptionList.BackgroundTransparency = 1
    OptionList.Parent = Dropdown
    
    local ListLayout = Instance.new("UIListLayout")
    ListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    ListLayout.Parent = OptionList
    
    local isOpen = false
    local function SelectOption(val)
        TitleLabel.Text = title .. ": " .. val
        TitleLabel.TextColor3 = THEME.Accent
        if callback then callback(val) end
        isOpen = false
        TweenService:Create(Dropdown, TweenInfo.new(0.3), {Size = UDim2.new(1, -5, 0, 35)}):Play()
        Arrow.Rotation = 0
    end
    
    for _, opt in ipairs(options) do
        local OptBtn = Instance.new("TextButton")
        OptBtn.Text = opt
        OptBtn.Size = UDim2.new(1, 0, 0, 30)
        OptBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        OptBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
        OptBtn.Font = THEME.Font
        OptBtn.TextSize = 13
        OptBtn.Parent = OptionList
        OptBtn.MouseButton1Click:Connect(function() SelectOption(opt) end)
    end
    
    OpenBtn.MouseButton1Click:Connect(function()
        isOpen = not isOpen
        if isOpen then
            local listHeight = (#options * 30)
            TweenService:Create(Dropdown, TweenInfo.new(0.3), {Size = UDim2.new(1, -5, 0, 35 + listHeight)}):Play()
            Arrow.Rotation = 180
        else
            TweenService:Create(Dropdown, TweenInfo.new(0.3), {Size = UDim2.new(1, -5, 0, 35)}):Play()
            Arrow.Rotation = 0
        end
    end)
end

-- --- H√ÄM T·∫†O TOGGLE (ƒê√É FIX L·ªÜCH) ---
local function CreateToggle(parentPage, text, callback)
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Size = UDim2.new(1, -5, 0, 35)
    ToggleFrame.BackgroundColor3 = THEME.ItemBack
    ToggleFrame.Parent = parentPage
    Instance.new("UICorner", ToggleFrame).CornerRadius = UDim.new(0, 6)
    
    local Label = Instance.new("TextLabel")
    Label.Text = text
    Label.Size = UDim2.new(1, -40, 1, 0)
    Label.Position = UDim2.new(0, 10, 0, 0)
    Label.BackgroundTransparency = 1
    Label.TextColor3 = THEME.Text
    Label.Font = THEME.Font
    Label.TextSize = 14
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = ToggleFrame
    
    local ClickBtn = Instance.new("TextButton")
    ClickBtn.Size = UDim2.new(1, 0, 1, 0)
    ClickBtn.BackgroundTransparency = 1
    ClickBtn.Text = ""
    ClickBtn.Parent = ToggleFrame
    
    local BoxOuter = Instance.new("Frame")
    BoxOuter.AnchorPoint = Vector2.new(1, 0.5) -- Neo v√†o c·∫°nh ph·∫£i, gi·ªØa
    BoxOuter.Size = UDim2.new(0, 22, 0, 22)
    BoxOuter.Position = UDim2.new(1, -10, 0.5, 0)
    BoxOuter.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    BoxOuter.Parent = ToggleFrame
    Instance.new("UICorner", BoxOuter).CornerRadius = UDim.new(0, 4)
    local BoxStroke = Instance.new("UIStroke")
    BoxStroke.Color = Color3.fromRGB(100, 100, 100)
    BoxStroke.Thickness = 1
    BoxStroke.Parent = BoxOuter
    
    local BoxInner = Instance.new("Frame")
    BoxInner.AnchorPoint = Vector2.new(0.5, 0.5) -- Neo v√†o t√¢m
    BoxInner.Size = UDim2.new(0, 14, 0, 14)
    BoxInner.Position = UDim2.new(0.5, 0, 0.5, 0)
    BoxInner.BackgroundColor3 = THEME.Accent
    BoxInner.BackgroundTransparency = 1 
    BoxInner.Parent = BoxOuter
    Instance.new("UICorner", BoxInner).CornerRadius = UDim.new(0, 3)
    
    local isOn = false
    ClickBtn.MouseButton1Click:Connect(function()
        isOn = not isOn
        if isOn then
            TweenService:Create(BoxInner, TweenInfo.new(0.2), {BackgroundTransparency = 0}):Play()
            BoxStroke.Color = THEME.Accent
            Label.TextColor3 = THEME.Accent
        else
            TweenService:Create(BoxInner, TweenInfo.new(0.2), {BackgroundTransparency = 1}):Play()
            BoxStroke.Color = Color3.fromRGB(100, 100, 100)
            Label.TextColor3 = THEME.Text
        end
        if callback then callback(isOn) end
    end)
end

local function CreateCenteredHeader(parentPage, text)
    local Header = Instance.new("TextLabel")
    Header.Text = text
    Header.Size = UDim2.new(1, 0, 0, 30)
    Header.BackgroundTransparency = 1
    Header.TextColor3 = THEME.Accent
    Header.Font = Enum.Font.FredokaOne
    Header.TextSize = 20
    Header.TextXAlignment = Enum.TextXAlignment.Center
    Header.Parent = parentPage
end

local function CreateStatusLabel(parentPage, title, defaultValue)
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(1, -5, 0, 35)
    Frame.BackgroundColor3 = THEME.ItemBack
    Frame.Parent = parentPage
    Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 6)
    local TitleLabel = Instance.new("TextLabel"); TitleLabel.Text = title; TitleLabel.Size = UDim2.new(0.4, 0, 1, 0); TitleLabel.Position = UDim2.new(0, 10, 0, 0); TitleLabel.BackgroundTransparency = 1; TitleLabel.TextColor3 = Color3.fromRGB(180, 180, 180); TitleLabel.Font = THEME.Font; TitleLabel.TextSize = 14; TitleLabel.TextXAlignment = Enum.TextXAlignment.Left; TitleLabel.Parent = Frame
    local ValueLabel = Instance.new("TextLabel"); ValueLabel.Text = defaultValue; ValueLabel.Size = UDim2.new(0.6, -10, 1, 0); ValueLabel.Position = UDim2.new(1, -10, 0, 0); ValueLabel.AnchorPoint = Vector2.new(1, 0); ValueLabel.BackgroundTransparency = 1; ValueLabel.TextColor3 = THEME.Accent; ValueLabel.Font = Enum.Font.GothamBold; ValueLabel.TextSize = 14; ValueLabel.TextXAlignment = Enum.TextXAlignment.Right; ValueLabel.Parent = Frame
    return ValueLabel
end

local function FormatNumber(n) return tostring(n):reverse():gsub("%d%d%d", "%1,"):reverse():gsub("^,", "") end

-- =========================================================
-- PH·∫¶N 4: 11 TAB + N·ªòI DUNG
-- =========================================================

local Tab1 = CreateTab("Status")
local Tab2 = CreateTab("Auto Farm")
local Tab3 = CreateTab("Sea")
local Tab4 = CreateTab("Islands")
local Tab5 = CreateTab("Quest/Items")
local Tab6 = CreateTab("Fruit/Raid")
local Tab7 = CreateTab("Teleport")
local Tab8 = CreateTab("Visuals")
local Tab9 = CreateTab("Shop")
local Tab10 = CreateTab("Misc")
local Tab11 = CreateTab("Leviathan")

Tab1.Visible = true

-- --- TAB 1 (STATUS) ---
CreateCenteredHeader(Tab1, "TR·∫†NG TH√ÅI")
local TimeLabel = CreateStatusLabel(Tab1, "Th·ªùi gian :", "00:00:00")
local BeliLabel = CreateStatusLabel(Tab1, "Beli :", "Loading...")
local FragLabel = CreateStatusLabel(Tab1, "ƒêi·ªÉm t√≠m :", "Loading...")
local BountyLabel = CreateStatusLabel(Tab1, "Ti·ªÅn th∆∞·ªüng :", "Loading...")
local FruitLabel = CreateStatusLabel(Tab1, "Tr√°i √°c qu·ª∑ :", "Loading...")

task.spawn(function()
    local StartTime = tick()
    while task.wait(1) do
        local elapsed = tick() - StartTime
        local h = math.floor(elapsed / 3600); local m = math.floor((elapsed % 3600) / 60); local s = math.floor(elapsed % 60)
        TimeLabel.Text = string.format("%02d:%02d:%02d", h, m, s)
        if LocalPlayer:FindFirstChild("Data") then
            if LocalPlayer.Data:FindFirstChild("Beli") then BeliLabel.Text = FormatNumber(LocalPlayer.Data.Beli.Value) .. "$" end
            if LocalPlayer.Data:FindFirstChild("Fragments") then FragLabel.Text = FormatNumber(LocalPlayer.Data.Fragments.Value) .. " ∆í" end
            if LocalPlayer.Data:FindFirstChild("DevilFruit") then FruitLabel.Text = tostring(LocalPlayer.Data.DevilFruit.Value) else FruitLabel.Text = "Kh√¥ng c√≥" end
        end
        if LocalPlayer:FindFirstChild("leaderstats") and LocalPlayer.leaderstats:FindFirstChild("Bounty") then BountyLabel.Text = FormatNumber(LocalPlayer.leaderstats.Bounty.Value) end
    end
end)

-- --- TAB 2 (AUTO FARM) ---
CreateDropdown(Tab2, "Select Tool", {"Melee", "Sword", "Fruit"}, function(val)
    print("V≈© kh√≠:", val)
end)

CreateCenteredHeader(Tab2, "AUTO FARM")

CreateToggle(Tab2, "Auto Farm Level", function(state)
    print("Farm Level:", state)
end)

CreateToggle(Tab2, "Auto Farm Nearest", function(state)
    print("Farm Nearest:", state)
end)
